<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥·çƒè¡£è¡Œæ‰“å­—éŠæˆ²</title>
    <style>
        body {
            font-family: "Microsoft JhengHei", Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game-container {
            width: 500px;
            height: 90vh;
            max-height: 600px;
            border: 2px solid #aaa;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        #settings, #game, #results {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white;
        }
        #game, #results {
            display: none;
        }


        select, button, input {
            margin: 10px;
            padding: 5px;
            font-size: 16px;
        }
        #word-container {
            width: 100%;
            height: 70%; /* èª¿æ•´å–®è©å®¹å™¨é«˜åº¦ */
            position: relative;
            overflow: hidden;
        }
        .word {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            font-size: 32px;
            animation: fall linear;
        }
        @keyframes fall {
            from { top: 0px; }
            to { top: 100%; }
        }
        #score, #timer {
            position: absolute;
            top: 15px;
            font-size: 16px;
        }
        #score {
            right: 15px;
        }
        #timer {
            left: 60px;
        }
        #pinyin {
            font-size: 16px;
            color: #666;
            height: 20px;
            margin-bottom: 5px;
        }
        #input-area {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 10px;
            width: 100%;
        }
        #input {
            width: 60%; /* èª¿æ•´å¯¬åº¦ï¼Œå¯ä»¥æ ¹æ“šéœ€è¦æ›´æ”¹ */
            max-width: 250px; /* è¨­ç½®æœ€å¤§å¯¬åº¦ */
            padding: 8px 12px; /* èª¿æ•´å…§é‚Šè· */
            font-size: 24px; /* èª¿æ•´å­—é«”å¤§å° */
            text-align: center;
            border: 2px solid #ccc; /* æ·»åŠ é‚Šæ¡† */
            border-radius: 20px; /* åœ“è§’é‚Šæ¡† */
            outline: none; /* ç§»é™¤ç„¦é»æ™‚çš„å¤–é‚Šæ¡† */
            transition: border-color 0.3s ease; /* æ·»åŠ éæ¸¡æ•ˆæœ */
        }
        #input:focus {
            border-color: #0077cc;
        }
        select {
            width: 200px;
        }

        #results {
            text-align: center;
        }
        #game-stats {
            margin-top: 20px;
            text-align: left;
            display: inline-block;
        }
        #game-stats p {
            margin: 5px 0;
        }




        #end-button {
            position: absolute;
            top: 0px;
            left: 10px;
            width: 30px;
            height: 30px;
            background-color: #ccc;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        #end-button:hover {
            background-color: #ff1a1a;
        }
        #game {
            /* ... å…¶ä»–åŸæœ‰æ¨£å¼ ... */
            position: relative;
        }
    </style>
</head>
<body>
    <div id="game-container">
	
        <div id="settings">
		<h1>ğŸ¥·åº·è»’å°äº”æ‰“å­—å¤§è³½</h1>
            <select id="category"></select>
            <select id="order">
                <option value="sequential">æŒ‰é †åº</option>
                <option value="random">éš¨æ©Ÿ</option>
            </select>

            <select id="time">
                <option value="60">60 ç§’</option>
                <option value="90">90 ç§’</option>
                <option value="120">120 ç§’</option>
                <option value="stopwatch">ç¢¼è¡¨</option>
            </select>

            <select id="speed">
                <option value="slow" selected>å¹³ç©©</option>
                <option value="medium">å¿«èµ°</option>
                <option value="fast">å¥”è·‘</option>
            </select>
            <button id="start-button">é–‹å§‹éŠæˆ²</button>
        </div>
        <div id="game">
            <button id="end-button">X</button>
            <div id="word-container"></div>
            <div id="input-area">
                <input type="text" id="input" placeholder="">
            </div>
            <div id="pinyin"></div>
            <div id="score">å¾—åˆ†: 0</div>
            <div id="timer">æ™‚é–“: 0</div>
        </div>
        <div id="results">
            <h2>ğŸŠåŠªåŠ›æˆæœ</h2>
            <p id="final-score"></p>
            <div id="game-stats">
                <p id="category-result"></p>
                <p id="order-result"></p>
                <p id="time-result"></p>
                <p id="speed-result"></p>
            </div>
            <button id="return-button">è¿”å› ğŸ›¸</button>
        </div>
    </div>

    <script>
        const data = `
åº·5101	èšŠå¸³	ã„¨ã„£ËŠ ã„“ã„¤Ë‹	èšŠå¸³
åº·5101	éæ´²	ã„ˆã„Ÿ ã„“ã„¡	éæ´²
åº·5101	ç˜§ç–¾	ã„‹ã„©ã„Ë‹ ã„ã„§ËŠ	ç˜§ç–¾
åº·5101	é¼“å‹µ	ã„ã„¨Ë‡ ã„Œã„§Ë‹	é¼“å‹µ
åº·5101	å‹Ÿé›†	ã„‡ã„¨Ë‹ ã„ã„§ËŠ	å‹Ÿé›†
åº·5101	æè´ˆ	ã„ã„©ã„¢ ã„—ã„¥Ë‹	æè´ˆ
åº·5101	ç¾©è³£	ã„§Ë‹ ã„‡ã„Ë‹	ç¾©è³£
åº·5101	çç‹€	ã„ã„§ã„¤Ë‡ ã„“ã„¨ã„¤Ë‹	çç‹€
åº·5101	é›œèªŒ	ã„—ã„šËŠ ã„“Ë‹	é›œèªŒ
åº·5101	åŸºé‡‘æœƒ	ã„ã„§ ã„ã„§ã„£ ã„ã„¨ã„ŸË‹	åŸºé‡‘æœƒ
åº·5101	æ½›åŠ›	ã„‘ã„§ã„¢ËŠ ã„Œã„§Ë‹	æ½›åŠ›
åº·5102	å¾·åœ‹	ã„‰ã„œËŠ ã„ã„¨ã„›ËŠ	å¾·åœ‹
åº·5102	ä¼¼ä¹	ã„™Ë‹ ã„ã„¨	ä¼¼ä¹
åº·5102	è¡€æ¶²	ã„’ã„©ã„Ë‹ ã„§Ë‹	è¡€æ¶²
åº·5102	æ‹æ”	ã„†ã„ ã„•ã„œË‹	æ‹æ”
åº·5102	é¢±é¢¨	ã„Šã„ËŠ ã„ˆã„¥	é¢±é¢¨
åº·5102	è¨˜éŒ„	ã„ã„§Ë‹ ã„Œã„¨Ë‹	è¨˜éŒ„
åº·5102	å“€æ„	ã„ ã„”ã„¡ËŠ	å“€æ„
åº·5102	å±±å·’	ã„•ã„¢ ã„Œã„¨ã„¢ËŠ	å±±å·’
åº·5102	ç¸±è°·	ã„—ã„¨ã„¥Ë‹ ã„ã„¨Ë‡	ç¸±è°·
åº·5102	è‡å¸¶	ã„‘ã„§ËŠ ã„‰ã„Ë‹	è‡å¸¶
åº·5102	äººç¦	ã„–ã„£ËŠ ã„ã„¨ã„›Ë‹	äººç¦
åº·5102	æ®˜ç ´	ã„˜ã„¢ËŠ ã„†ã„›Ë‹	æ®˜ç ´
åº·5102	æª³æ¦”	ã„…ã„§ã„¥ ã„Œã„¤ËŠ	æª³æ¦”
åº·5102	æ±™æ°´	ã„¨ ã„•ã„¨ã„ŸË‡	æ±™æ°´
åº·5103	æ†§æ†¬	ã„”ã„¨ã„¥ ã„ã„§ã„¥Ë‡	æ†§æ†¬
åº·5103	ç„¡æ­¢å¢ƒ	ã„¨ËŠ ã„“Ë‡ ã„ã„§ã„¥Ë‹	ç„¡æ­¢å¢ƒ
åº·5103	ç¥ˆé¡˜	ã„‘ã„§ËŠ ã„©ã„¢Ë‹	ç¥ˆé¡˜
åº·5103	å‡æœ›	ã„‹ã„§ã„¥ËŠ ã„¨ã„¤Ë‹	å‡æœ›
åº·5103	æ´‹æº¢	ã„§ã„¤ËŠ ã„§Ë‹	æ´‹æº¢
åº·5103	è—‰ç”±	ã„ã„§ã„Ë‹ ã„§ã„¡ËŠ	è—‰ç”±
åº·5103	è©©å¥	ã„• ã„ã„©Ë‹	è©©å¥
åº·5103	å»£é—Š	ã„ã„¨ã„¤Ë‡ ã„ã„¨ã„›Ë‹	å»£é—Š
åº·5103	è±¡å¾µ	ã„’ã„§ã„¤Ë‹ ã„“ã„¥	è±¡å¾µ
åº·5103	å¼·çƒˆ	ã„‘ã„§ã„¤ËŠ ã„Œã„§ã„Ë‹	å¼·çƒˆ
åº·5103	ç¢ºå®š	ã„‘ã„©ã„Ë‹ ã„‰ã„§ã„¥Ë‹	ç¢ºå®š
åº·5103	é¡¯ç¾	ã„’ã„§ã„¢Ë‡ ã„’ã„§ã„¢Ë‹	é¡¯ç¾
åº·5103	è±å¯Œ	ã„ˆã„¥ ã„ˆã„¨Ë‹	è±å¯Œ
åº·5103	å³ä½¿	ã„ã„§ËŠ ã„•Ë‡	å³ä½¿
åº·5104	æ†ä¹…	ã„ã„¥ËŠ ã„ã„§ã„¡Ë‡	æ†ä¹…
åº·5104	é»ƒæ¾„æ¾„	ã„ã„¨ã„¤ËŠ ã„”ã„¥ËŠ ã„”ã„¥ËŠ	é»ƒæ¾„æ¾„
åº·5104	ç¨»ç©—	ã„‰ã„ Ë‹ ã„™ã„¨ã„ŸË‹	ç¨»ç©—
åº·5104	é¤Šæ´»	ã„§ã„¤Ë‡ ã„ã„¨ã„›ËŠ	é¤Šæ´»
åº·5104	ä¾†æº	ã„Œã„ËŠ ã„©ã„¢ËŠ	ä¾†æº
åº·5104	è—è¡“å®¶	ã„§Ë‹ ã„•ã„¨Ë‹ ã„ã„§ã„š	è—è¡“å®¶
åº·5104	æ¨¸å¯¦	ã„†ã„¨ËŠ ã„•ËŠ	æ¨¸å¯¦
åº·5104	æ’¿æ‹¾	ã„ã„§ã„¢Ë‡ ã„•ËŠ	æ’¿æ‹¾
åº·5104	é ­å·¾	ã„Šã„¡ËŠ ã„ã„§ã„£	é ­å·¾
åº·5104	æ¨¸ç´ 	ã„†ã„¨ËŠ ã„™ã„¨Ë‹	æ¨¸ç´ 
åº·5104	å°Šåš´	ã„—ã„¨ã„£ ã„§ã„¢ËŠ	å°Šåš´
åº·5104	ä»»å‹ä»»æ€¨	ã„–ã„£Ë‹ ã„Œã„ ËŠ ã„–ã„£Ë‹ ã„©ã„¢Ë‹	ä»»å‹ä»»æ€¨
åº·5104	æ…·æ…¨	ã„ã„¤ ã„ã„Ë‡	æ…·æ…¨
åº·5104	æ»‹æ½¤	ã„— ã„–ã„¨ã„£Ë‹	æ»‹æ½¤
åº·5105	å•†è­½	ã„•ã„¤ ã„©Ë‹	å•†è­½
åº·5105	æœå‹™	ã„ˆã„¨ËŠ ã„¨Ë‹	æœå‹™
åº·5105	é—œè¯	ã„ã„¨ã„¢ ã„Œã„§ã„¢ËŠ	é—œè¯
åº·5105	æ ¸å‡†	ã„ã„œËŠ ã„“ã„¨ã„£Ë‡	æ ¸å‡†
åº·5105	ç”³è«‹	ã„•ã„£ ã„‘ã„§ã„¥Ë‡	ç”³è«‹
åº·5105	é»‘æ¾	ã„ã„Ÿ ã„™ã„¨ã„¥	é»‘æ¾
åº·5105	è¨»å†Š	ã„“ã„¨Ë‹ ã„˜ã„œË‹	è¨»å†Š
åº·5105	ä¼æ¥­	ã„‘ã„§Ë‹ ã„§ã„Ë‹	ä¼æ¥­
åº·5105	æ­·ç¶“	ã„Œã„§Ë‹ ã„ã„§ã„¥	æ­·ç¶“
åº·5105	è‹±æ–‡	ã„§ã„¥ ã„¨ã„£ËŠ	è‹±æ–‡
åº·5105	éŠ·å”®	ã„’ã„§ã„  ã„•ã„¡Ë‹	éŠ·å”®
åº·5105	èˆ‰è¾¦	ã„ã„©Ë‡ ã„…ã„¢Ë‹	èˆ‰è¾¦
åº·5105	éœ¸ä¸»	ã„…ã„šË‹ ã„“ã„¨Ë‡	éœ¸ä¸»
åº·5105	é …ç›®	ã„’ã„§ã„¤Ë‹ ã„‡ã„¨Ë‹	é …ç›®
åº·5106	èåˆ	ã„–ã„¨ã„¥ËŠ ã„ã„œËŠ	èåˆ
åº·5106	å¨›æ¨‚	ã„©ËŠ ã„Œã„œË‹	å¨›æ¨‚
åº·5106	æ±½èˆ¹	ã„‘ã„§Ë‹ ã„”ã„¨ã„¢ËŠ	æ±½èˆ¹
åº·5106	åˆ†é˜	ã„ˆã„£ ã„“ã„¨ã„¥	åˆ†é˜
åº·5106	å£å“¨	ã„ã„¡Ë‡ ã„•ã„ Ë‹	å£å“¨
åº·5106	è§€çœ¾	ã„ã„¨ã„¢ ã„“ã„¨ã„¥Ë‹	è§€çœ¾
åº·5106	ç¶“å…¸	ã„ã„§ã„¥ ã„‰ã„§ã„¢Ë‡	ç¶“å…¸
åº·5106	æˆ°çˆ­	ã„“ã„¢Ë‹ ã„“ã„¥	æˆ°çˆ­
åº·5106	å¹³è¡¡	ã„†ã„§ã„¥ËŠ ã„ã„¥ËŠ	å¹³è¡¡
åº·5106	å…±é³´	ã„ã„¨ã„¥Ë‹ ã„‡ã„§ã„¥ËŠ	å…±é³´
åº·5106	æ¡†æ¶	ã„ã„¨ã„¤ ã„ã„§ã„šË‹	æ¡†æ¶
åº·5106	å±¬æ–¼	ã„•ã„¨Ë‡ ã„©ËŠ	å±¬æ–¼
åº·5106	åŠ‡æƒ…	ã„ã„©Ë‹ ã„‘ã„§ã„¥ËŠ	åŠ‡æƒ…
åº·5106	ç²å¾—	ã„ã„¨ã„›Ë‹ ã„‰ã„œËŠ	ç²å¾—
åº·5106	ç´°è†©	ã„’ã„§Ë‹ ã„‹ã„§Ë‹	ç´°è†©
åº·5106	é¸æ“‡	ã„’ã„©ã„¢Ë‡ ã„—ã„œËŠ	é¸æ“‡
åº·5106	æ¨£è²Œ	ã„§ã„¤Ë‹ ã„‡ã„ Ë‹	æ¨£è²Œ
åº·5106	æ„Ÿå®˜	ã„ã„¢Ë‡ ã„ã„¨ã„¢	æ„Ÿå®˜
åº·5107	é€†é¢¨	ã„‹ã„§Ë‹ ã„ˆã„¥	é€†é¢¨
åº·5107	å¯æ†	ã„ã„œË‡ ã„Œã„§ã„¢ËŠ	å¯æ†
åº·5107	å³­å£	ã„‘ã„§ã„ Ë‹ ã„…ã„§Ë‹	å³­å£
åº·5107	ç‰©ç«¶å¤©æ“‡	ã„¨Ë‹ ã„ã„§ã„¥Ë‹ ã„Šã„§ã„¢ ã„—ã„œËŠ	ç‰©ç«¶å¤©æ“‡
åº·5107	å¥½é€¸æƒ¡å‹	ã„ã„ Ë‹ ã„§Ë‹ ã„¨Ë‹ ã„Œã„ ËŠ	å¥½é€¸æƒ¡å‹
åº·5107	é …éŠ	ã„’ã„§ã„¤Ë‹ ã„Œã„§ã„¢Ë‹	é …éŠ
åº·5107	æ¸¾åœ“	ã„ã„¨ã„£ËŠ ã„©ã„¢ËŠ	æ¸¾åœ“
åº·5107	é†œé™‹	ã„”ã„¡Ë‡ ã„Œã„¡Ë‹	é†œé™‹
åº·5107	ä»£åƒ¹	ã„‰ã„Ë‹ ã„ã„§ã„šË‹	ä»£åƒ¹
åº·5107	ç›²äºº	ã„‡ã„¤ËŠ ã„–ã„£ËŠ	ç›²äºº
åº·5108	å·´åŸºæ–¯å¦	ã„…ã„š ã„ã„§ ã„™ ã„Šã„¢Ë‡	å·´åŸºæ–¯å¦
åº·5108	çˆ¶è¦ª	ã„ˆã„¨Ë‹ ã„‘ã„§ã„£	çˆ¶è¦ª
åº·5108	ææ€–	ã„ã„¨ã„¥Ë‡ ã„…ã„¨Ë‹	ææ€–
åº·5108	çµ„ç¹”	ã„—ã„¨Ë‡ ã„“	çµ„ç¹”
åº·5108	éœ¸å 	ã„…ã„šË‹ ã„“ã„¢Ë‹	éœ¸å 
åº·5108	å»£æ’­	ã„ã„¨ã„¤Ë‡ ã„…ã„›Ë‹	å»£æ’­
åº·5108	æ§åˆ¶	ã„ã„¨ã„¥Ë‹ ã„“Ë‹	æ§åˆ¶
åº·5108	æ”»æ“Š	ã„ã„¨ã„¥ ã„ã„§ËŠ	æ”»æ“Š
åº·5108	å¨è„…	ã„¨ã„Ÿ ã„’ã„§ã„ËŠ	å¨è„…
åº·5108	åº·å¾©	ã„ã„¤ ã„ˆã„¨Ë‹	åº·å¾©
åº·5108	è»Ÿå¼±	ã„–ã„¨ã„¢Ë‡ ã„–ã„¨ã„›Ë‹	è»Ÿå¼±
åº·5108	æ­¦å™¨	ã„¨Ë‡ ã„‘ã„§Ë‹	æ­¦å™¨
åº·5108	éœ‡æ’¼	ã„“ã„£Ë‹ ã„ã„¢Ë‹	éœ‡æ’¼
åº·5108	ææ‡¼	ã„ã„¨ã„¥Ë‡ ã„ã„©Ë‹	ææ‡¼
åº·5109	æŒ«æŠ˜	ã„˜ã„¨ã„›Ë‹ ã„“ã„œËŠ	æŒ«æŠ˜
åº·5109	ç¶­æŒ	ã„¨ã„ŸËŠ ã„”ËŠ	ç¶­æŒ
åº·5109	å´å¶‡	ã„‘ã„§ËŠ ã„‘ã„©	å´å¶‡
åº·5109	è‰±è¾›	ã„ã„§ã„¢ ã„’ã„§ã„£	è‰±è¾›
åº·5109	åˆç¨¿	ã„”ã„¨ ã„ã„ Ë‡	åˆç¨¿
åº·5109	ç³»åˆ—	ã„’ã„§Ë‹ ã„Œã„§ã„Ë‹	ç³»åˆ—
åº·5109	ç¿»è­¯	ã„ˆã„¢ ã„§Ë‹	ç¿»è­¯
åº·5109	æ¸›å°‘	ã„ã„§ã„¢Ë‡ ã„•ã„ Ë‡	æ¸›å°‘
åº·5109	çµ¦äºˆ	ã„ã„§Ë‡ ã„©Ë‡	çµ¦äºˆ
åº·5109	å¹¼èŠ½	ã„§ã„¡Ë‹ ã„§ã„šËŠ	å¹¼èŠ½
åº·5109	æ¤°å­	ã„§ã„ËŠ ã„—Ë‡	æ¤°å­
åº·5109	è…çˆ›	ã„ˆã„¨Ë‡ ã„Œã„¢Ë‹	è…çˆ›
åº·5109	é›é€ 	ã„‰ã„¨ã„¢Ë‹ ã„—ã„ Ë‹	é›é€ 
åº·5110	å”æœ	ã„Šã„¤ËŠ ã„”ã„ ËŠ	å”æœ
åº·5110	æ¬æ·¡	ã„Šã„§ã„¢ËŠ ã„‰ã„¢Ë‹	æ¬æ·¡
åº·5110	æ—¥æš®	ã„–Ë‹ ã„‡ã„¨Ë‹	æ—¥æš®
åº·5110	æŸ´æ‰‰	ã„”ã„ËŠ ã„ˆã„Ÿ	æŸ´æ‰‰
åº·5110	å®Œç•¢	ã„¨ã„¢ËŠ ã„…ã„§Ë‹	å®Œç•¢
åº·5110	å‚æ™š	ã„…ã„¤Ë‹ ã„¨ã„¢Ë‡	å‚æ™š
åº·5110	é–’é©	ã„’ã„§ã„¢ËŠ ã„•Ë‹	é–’é©
åº·5110	å¹½äºº	ã„§ã„¡ ã„–ã„£ËŠ	å¹½äºº
åº·5110	éš±å±…	ã„§ã„£Ë‡ ã„ã„©	éš±å±…
åº·5110	å®˜è·	ã„ã„¨ã„¢ ã„“ËŠ	å®˜è·
åº·5110	åŸå”±	ã„§ã„£ËŠ ã„”ã„¤Ë‹	åŸå”±
åº·5110	ç©ºæ› 	ã„ã„¨ã„¥ ã„ã„¨ã„¤Ë‹	ç©ºæ› 
åº·5111	ç–¤ç—•	ã„…ã„š ã„ã„£ËŠ	ç–¤ç—•
åº·5111	éµç½	ã„Šã„§ã„Ë‡ ã„ã„¨ã„¢Ë‹	éµç½
åº·5111	å’šå’š	ã„‰ã„¨ã„¥ ã„‰ã„¨ã„¥	å’šå’š
åº·5111	ç¢°é‹æ°£	ã„†ã„¥Ë‹ ã„©ã„£Ë‹ ã„‘ã„§Ë‹	ç¢°é‹æ°£
åº·5111	å‚¾ç›†	ã„‘ã„§ã„¥ ã„†ã„£ËŠ	å‚¾ç›†
åº·5111	ç‡Ÿç«	ã„§ã„¥ËŠ ã„ã„¨ã„›Ë‡	ç‡Ÿç«
åº·5111	å´‡æ‹œ	ã„”ã„¨ã„¥ËŠ ã„…ã„Ë‹	å´‡æ‹œ
åº·5111	æ£„ç½®	ã„‘ã„§Ë‹ ã„“Ë‹	æ£„ç½®
åº·5111	å¥„å¥„ä¸€æ¯	ã„§ã„¢Ë‡ ã„§ã„¢Ë‡ ã„§Ë‹ ã„’ã„§	å¥„å¥„ä¸€æ¯
åº·5111	å°å¿ƒç¿¼ç¿¼	ã„’ã„§ã„ Ë‡ ã„’ã„§ã„£ ã„§Ë‹ ã„§Ë‹	å°å¿ƒç¿¼ç¿¼
åº·5111	ç¥ˆç¦±	ã„‘ã„§ËŠ ã„‰ã„ Ë‡	ç¥ˆç¦±
åº·5111	å¼è²	ã„ã„¡Ë‡ ã„•ã„¥	å¼è²
åº·5111	å–‰åš¨	ã„ã„¡ËŠ ã„Œã„¨ã„¥ËŠ	å–‰åš¨
åº·5112	æšˆèˆ¹	ã„©ã„£ ã„”ã„¨ã„¢ËŠ	æšˆèˆ¹
åº·5112	é»ƒæ˜	ã„ã„¨ã„¤ËŠ ã„ã„¨ã„£	é»ƒæ˜
åº·5112	èˆ¹è‰™	ã„”ã„¨ã„¢ËŠ ã„˜ã„¤	èˆ¹è‰™
åº·5112	é€”ä¸­	ã„Šã„¨ËŠ ã„“ã„¨ã„¥	é€”ä¸­
åº·5112	é‡ç¸	ã„§ã„Ë‡ ã„•ã„¡Ë‹	é‡ç¸
åº·5112	æ“±æ·º	ã„ã„œ ã„‘ã„§ã„¢Ë‡	æ“±æ·º
åº·5112	ç¤å²©	ã„ã„§ã„  ã„§ã„¢ËŠ	ç¤å²©
åº·5112	æœ¨ç­	ã„‡ã„¨Ë‹ ã„ˆã„šËŠ	æœ¨ç­
åº·5112	å€’å¡Œ	ã„‰ã„ Ë‡ ã„Šã„š	å€’å¡Œ
åº·5112	é¸šå“¥	ã„§ã„¥ ã„ã„œ	é¸šå“¥
åº·5112	çƒ¤çˆ	ã„ã„ Ë‡ ã„Œã„¨ËŠ	çƒ¤çˆ
`;

        const words = data.trim().split('\n').slice(1).map(line => {
            const [category, word, pinyin, meaning] = line.split('\t');
            return { category, word, pinyin, meaning };
        });

        const settings = document.getElementById('settings');
        const game = document.getElementById('game');
        const results = document.getElementById('results');
        const categorySelect = document.getElementById('category');
        const orderSelect = document.getElementById('order');
        const timeSelect = document.getElementById('time');
        const startButton = document.getElementById('start-button');
        const wordContainer = document.getElementById('word-container');
        const input = document.getElementById('input');
        const pinyinDisplay = document.getElementById('pinyin');
        const scoreDisplay = document.getElementById('score');
        const timerDisplay = document.getElementById('timer');
        const finalScoreDisplay = document.getElementById('final-score');
        const returnButton = document.getElementById('return-button');
        const speedSelect = document.getElementById('speed');

        let isStopwatch = false;
        let startTime;
        let endTime;

        let currentSpeed = 'slow';
		let baseSpeed = 'slow';
		let penaltyTime = 0;

        let gameWords = [];
        let currentWordIndex = 0;
        let score = 0;
        let timeLeft = 60;
        let timerInterval;
        let currentWord = null;

		// è§£æ data å­—ç¬¦ä¸²
		const parseData = (dataString) => {
			return dataString.trim().split('\n').slice(1).map(line => {
				const [category, word, pinyin, meaning] = line.split('\t');
				return { category, word, pinyin, meaning };
			});
		};

		// ç²å–å”¯ä¸€çš„åˆ†é¡
		const getUniqueCategories = (parsedData) => {
			return [...new Set(parsedData.map(item => item.category))];
		};

		// ç”Ÿæˆåˆ†é¡é¸é …
		const generateCategoryOptions = (categories) => {
			const categorySelect = document.getElementById('category');
			categorySelect.innerHTML = '<option value="all">å…¨éƒ¨åˆ†é¡</option>';
			
			categories.forEach(category => {
				const option = document.createElement('option');
				option.value = category;
				option.textContent = category;
				categorySelect.appendChild(option);
			});
		};

		// ä¸»å‡½æ•¸
		const initializeCategoryOptions = () => {
			const parsedData = parseData(data);
			const uniqueCategories = getUniqueCategories(parsedData);
			generateCategoryOptions(uniqueCategories);
		};

		// åœ¨ DOM åŠ è¼‰å®Œæˆå¾ŒåŸ·è¡Œ
		document.addEventListener('DOMContentLoaded', initializeCategoryOptions);

        startButton.addEventListener('click', startGame);
        input.addEventListener('keypress', handleInput);
        returnButton.addEventListener('click', returnToSettings);

        function startGame() {
            settings.style.display = 'none';
            game.style.display = 'flex';
            results.style.display = 'none';

			currentSpeed = speedSelect.value;
			baseSpeed = currentSpeed;
			penaltyTime = 0;
			startTime = Date.now();

            const selectedCategory = categorySelect.value;
            const selectedOrder = orderSelect.value;
            timeLeft = parseInt(timeSelect.value);

            gameWords = words.filter(word => selectedCategory === 'all' || word.category === selectedCategory);
            
            if (selectedOrder === 'random') {
                gameWords = shuffleArray(gameWords);
            }

            score = 0;
            updateScore(0);
            currentWordIndex = 0;
            wordContainer.innerHTML = '';
            input.value = '';
            pinyinDisplay.textContent = '';
            input.focus();

            gameSettings = {
                category: categorySelect.value,
                order: orderSelect.value,
                time: timeSelect.value,
                speed: speedSelect.value
            };


            const selectedTime = timeSelect.value;
            isStopwatch = selectedTime === 'stopwatch';
            
            if (isStopwatch) {
                timeLeft = 0;
                startTime = Date.now();
            } else {
                timeLeft = parseInt(selectedTime);
            }

            updateTimer();
            timerInterval = setInterval(() => {
                if (isStopwatch) {
                    timeLeft = Math.floor((Date.now() - startTime) / 1000);
                } else {
                    timeLeft--;
                }
                updateTimer();
                if (!isStopwatch && timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            spawnWord();
        }




		function spawnWord() {
			if (currentWordIndex < gameWords.length) {
				const wordData = gameWords[currentWordIndex];
				const wordElement = createWordElement(wordData.word);
				wordContainer.appendChild(wordElement);
				const fallDuration = getFallDuration();
				
				if (currentWord && currentWord.fallTimeout) {
					clearTimeout(currentWord.fallTimeout);
				}

				currentWord = { 
					element: wordElement, 
					data: wordData,
					startTime: Date.now()
				};

				wordElement.style.animation = `fall ${fallDuration}ms linear`;

				currentWord.fallTimeout = setTimeout(() => {
					if (wordElement.parentNode === wordContainer) {
						wordFell();
					}
				}, fallDuration);
			} else {
				currentWordIndex = 0;
				spawnWord();
			}
		}



        function getFallDuration() {
            switch (currentSpeed) {
                case 'slow':
                    return 18000;
                case 'fast':
                    return 8000;
                case 'medium':
                default:
                    return 12000;
            }
        }


		function getFallDuration() {
			let baseDuration;
			switch (baseSpeed) {
				case 'slow':
					baseDuration = 15000;
					break;
				case 'fast':
					baseDuration = 7000;
					break;
				case 'medium':
				default:
					baseDuration = 10000;
					break;
			}
			return Math.max(1000, baseDuration - penaltyTime);
		}

        function createWordElement(word) {
            const element = document.createElement('div');
            element.textContent = word;
            element.className = 'word';
            return element;
        }

		function handleInput(event) {
			if (event.key === 'Enter') {
				const typedWord = input.value.trim();
				if (currentWord && typedWord === currentWord.data.word) {
					clearTimeout(currentWord.fallTimeout);
					wordContainer.removeChild(currentWord.element);
					updateScore(10);
					currentWordIndex++;
					pinyinDisplay.textContent = '';
					penaltyTime = 0;
					input.value = '';
					spawnWord();
				} else {
					updateScore(-10);
					if (currentWord) {
						pinyinDisplay.textContent = `${currentWord.data.pinyin}`; // æ‹¼éŸ³æç¤º;
						penaltyTime -= 1000;
						updateWordSpeed();
					}
					input.value = '';
				}
			}
		}


		function updateWordSpeed() {
			if (currentWord && currentWord.element) {
				const newDuration = getFallDuration();
				const elapsedTime = Date.now() - currentWord.startTime;
				const remainingTime = Math.max(0, newDuration - elapsedTime);
				
				currentWord.element.style.animation = 'none';
				void currentWord.element.offsetWidth;
				currentWord.element.style.animation = `fall ${remainingTime}ms linear`;
				
				clearTimeout(currentWord.fallTimeout);
				currentWord.fallTimeout = setTimeout(() => {
					if (currentWord.element.parentNode === wordContainer) {
						wordFell();
					}
				}, remainingTime);
			}
		}


		function resetWordSpeed() {
			if (currentWord && currentWord.element) {
				const newDuration = getFallDuration();
				currentWord.element.style.animation = 'none';
				void currentWord.element.offsetWidth;
				currentWord.element.style.animation = `fall ${newDuration}ms linear`;
				
				clearTimeout(currentWord.fallTimeout);
				currentWord.fallTimeout = setTimeout(() => {
					if (currentWord.element.parentNode === wordContainer) {
						wordFell();
					}
				}, newDuration);
			}
		}



		function wordFell() {
			if (currentWord) {
				updateScore(-10);
				pinyinDisplay.textContent = `æ‹¼éŸ³: ${currentWord.data.pinyin}`;
				respawnWord();
			}
		}





		function respawnWord() {
			if (currentWord) {
				if (currentWord.fallTimeout) {
					clearTimeout(currentWord.fallTimeout);
				}
				if (currentWord.element && currentWord.element.parentNode === wordContainer) {
					wordContainer.removeChild(currentWord.element);
				}
				const wordElement = createWordElement(currentWord.data.word);
				wordContainer.appendChild(wordElement);
				const fallDuration = getFallDuration();
				
				currentWord.element = wordElement;
				currentWord.startTime = Date.now();

				wordElement.style.animation = `fall ${fallDuration}ms linear`;

				currentWord.fallTimeout = setTimeout(() => {
					if (wordElement.parentNode === wordContainer) {
						wordFell();
					}
				}, fallDuration);
			}
		}

		function updateScore(points) {
			score += points;
			score = Math.max(0, score);
			scoreDisplay.textContent = `å¾—åˆ†: ${score}`;
		}

        function updateTimer() {
            timerDisplay.textContent = `æ™‚é–“: ${timeLeft}`;
        }


        const endButton = document.getElementById('end-button');
        endButton.addEventListener('click', endGame);


        function endGame() {
            endTime = Date.now();
            clearInterval(timerInterval);
            if (currentWord && currentWord.fallTimeout) {
                clearTimeout(currentWord.fallTimeout);
            }
            game.style.display = 'none';
            results.style.display = 'flex';
            finalScoreDisplay.textContent = `âœ¨å¾—åˆ†: ${score}`;
            
            const totalSeconds = Math.floor((endTime - startTime) / 1000);
            
            // æ›´æ–°éŠæˆ²è¨­ç½®é¡¯ç¤º
            document.getElementById('category-result').textContent = `åˆ†é¡: ${getCategoryName(gameSettings.category)}`;
            document.getElementById('order-result').textContent = `é †åº: ${getOrderName(gameSettings.order)}`;
            document.getElementById('time-result').textContent = `æ™‚é–“: ${totalSeconds} ç§’`;
            document.getElementById('speed-result').textContent = `é€Ÿåº¦: ${getSpeedName(gameSettings.speed)}`;
        }
		

		// å‹•æ…‹ç”Ÿæˆ getCategoryName å‡½æ•¸
		function createGetCategoryName() {
			const categoryOptions = Array.from(document.getElementById('category').options);
			const categoryMap = Object.fromEntries(
				categoryOptions.map(option => [option.value, option.textContent])
			);
			
			return function getCategoryName(category) {
				return categoryMap[category] || category;
			};
		}

		// å‹•æ…‹ç”Ÿæˆ getOrderName å‡½æ•¸
		function createGetOrderName() {
			const orderOptions = Array.from(document.getElementById('order').options);
			const orderMap = Object.fromEntries(
				orderOptions.map(option => [option.value, option.textContent])
			);
			
			return function getOrderName(order) {
				return orderMap[order] || order;
			};
		}

		// å‹•æ…‹ç”Ÿæˆ getTimeName å‡½æ•¸
		function createGetTimeName() {
			const timeOptions = Array.from(document.getElementById('time').options);
			const timeMap = Object.fromEntries(
				timeOptions.map(option => [option.value, `${option.value} ç§’`])
			);
			
			return function getTimeName(time) {
				return timeMap[time] || `${time} ç§’`;
			};
		}

		// å‹•æ…‹ç”Ÿæˆ getSpeedName å‡½æ•¸
		function createGetSpeedName() {
			const speedOptions = Array.from(document.getElementById('speed').options);
			const speedMap = Object.fromEntries(
				speedOptions.map(option => [option.value, option.textContent])
			);
			
			return function getSpeedName(speed) {
				return speedMap[speed] || speed;
			};
		}

        function returnToSettings() {
            results.style.display = 'none';
            settings.style.display = 'flex';
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }


		document.addEventListener('DOMContentLoaded', () => {
			window.getCategoryName = createGetCategoryName();
			window.getOrderName = createGetOrderName();
			window.getTimeName = createGetTimeName();
			window.getSpeedName = createGetSpeedName();
		});

    </script>
</body>
</html>